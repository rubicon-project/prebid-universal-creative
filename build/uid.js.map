{"version":3,"sources":["webpack:///webpack/bootstrap eaa1a05b7f0f456e7cc2","webpack:///./src/ssp-userids/uid.js","webpack:///./src/ssp-userids/commons.js"],"names":["window","pbs","getBuyerUids","ENDPOINT","STORAGE_KEY","REFRESH_IN_DAYS","callback","uidData","commons","hasInvalidData","loadData","JSON","parse","e","lastUpdated","saveData","response","stringify","withCredentials","noop","setDataInLocalStorage","key","value","hasLocalStorage","localStorage","setItem","getDataFromLocalStorage","getItem","console","log","timestamp","Date","getTime","ajax","url","data","options","timeout","x","method","callbacks","success","error","XMLHttpRequest","onreadystatechange","readyState","status","responseText","statusText","ontimeout","urlInfo","parseURL","search","formatURL","open","preflight","setRequestHeader","contentType","send"],"mappings":"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","file":"uid.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap eaa1a05b7f0f456e7cc2","/**\n * This script returns the ssp buyer user id's. \n * Usage: \n * Load the script on the page from jsDelivr <TODO update url here>\n * window.pbs.getBuyerUids(function(error, uids) {\n *    // use uids here\n * })\n */\n\nimport * as commons from './commons';\n\nwindow.pbs = (window.pbs || {})\nwindow.pbs.getBuyerUids = getBuyerUids;\n\nconst ENDPOINT = 'https://prebid.adnxs.com/pbs/v1/getuids';\nconst STORAGE_KEY = 'ssp-buyeruids';\nconst REFRESH_IN_DAYS = 14;\n\n/**\n * This functions calls the callback when buyer userid's is ready\n * @param {function} callback \n */\nexport function getBuyerUids(callback) {\n  let uidData = commons.getDataFromLocalStorage(STORAGE_KEY);\n  if (hasInvalidData(uidData)) {\n    loadData(callback);\n  } else {\n    try {\n      uidData = JSON.parse(uidData);\n    } catch (e) {\n      callback(e, null);\n      return;\n    }\n    delete uidData.lastUpdated;\n    callback(null, uidData);\n  }\n}\n\n/**\n * Gets the data from prebid server getuid endpoint and store it in local storage\n * @param {function} callback \n */\nexport function loadData(callback) {\n  function saveData(response) {\n    try {\n      response = JSON.parse(response);\n      response['lastUpdated'] = commons.timestamp();\n      commons.setDataInLocalStorage(STORAGE_KEY, JSON.stringify(response));\n      delete response.lastUpdated;\n      callback(null, response);\n    } catch (e) {\n      callback(e, null);\n    }\n  }\n\n  let uidData = commons.getDataFromLocalStorage(STORAGE_KEY);\n  if (hasInvalidData(uidData)) {\n    commons.ajax(ENDPOINT, saveData, null, {\n      withCredentials: true\n    });\n  }\n}\n\n/**\n * Check whether buyer id data is not null and is not expired\n * @param {Object} uidData \n * @returns {boolean}\n */\nfunction hasInvalidData(uidData) {\n  return !uidData || commons.timestamp() > uidData.lastUpdated + REFRESH_IN_DAYS * 24 * 60 * 60 * 1000\n}\n\nfunction noop() {}\nloadData(noop);\n\n\n// WEBPACK FOOTER //\n// ./src/ssp-userids/uid.js","/**\n * Store data in local storage\n * @param {string} key \n * @param {string} value \n */\n\nexport function setDataInLocalStorage(key, value) {\n  if (hasLocalStorage()) {\n    window.localStorage.setItem(key, value);\n  }\n}\n\n/**\n * Get data from local storage\n * @param {string} key \n */\nexport function getDataFromLocalStorage(key) {\n  if (hasLocalStorage()) {\n    return window.localStorage.getItem(key);\n  }\n}\n\n/**\n * Check local storage is supported or not\n */\nexport function hasLocalStorage() {\n  try {\n    return !!window.localStorage;\n  } catch (e) {\n    console.log('Local storage api disabled');\n  }\n}\n\nexport function timestamp() {\n  return new Date().getTime();\n}\n\nexport function ajax(url, callback, data, options = {}) {\n  try {\n    let timeout = 3000;\n    let x;\n    let method = options.method || (data ? 'POST' : 'GET');\n\n    let callbacks = typeof callback === 'object' ? callback : {\n      success: function() {\n        console.log('xhr success');\n      },\n      error: function(e) {\n        console.log('xhr error', null, e);\n      }\n    };\n\n    if (typeof callback === 'function') {\n      callbacks.success = callback;\n    }\n\n    x = new window.XMLHttpRequest();\n    x.onreadystatechange = function () {\n      if (x.readyState === 4) {\n        let status = x.status;\n        if ((status >= 200 && status < 300) || status === 304) {\n          callbacks.success(x.responseText, x);\n        } else {\n          callbacks.error(x.statusText, x);\n        }\n      }\n    };\n    x.ontimeout = function () {\n      console.log('xhr timeout after ', x.timeout, 'ms');\n    };\n\n    if (method === 'GET' && data) {\n      let urlInfo = parseURL(url, options);\n      Object.assign(urlInfo.search, data);\n      url = formatURL(urlInfo);\n    }\n\n    x.open(method, url);\n    // IE needs timoeut to be set after open - see #1410\n    x.timeout = timeout;\n\n    if (options.withCredentials) {\n      x.withCredentials = true;\n    }\n    if (options.preflight) {\n      x.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n    }\n    x.setRequestHeader('Content-Type', options.contentType || 'text/plain');\n\n    if (method === 'POST' && data) {\n      x.send(data);\n    } else {\n      x.send();\n    }\n  } catch (error) {\n    console.log('xhr construction', error);\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ssp-userids/commons.js"],"sourceRoot":""}